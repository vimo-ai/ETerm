import{d as O,c as A,b as a,k as n,e,n as b,t as r,r as c,u as j,o as B,y as E,a as F,f as h,m as H,F as I,j as w,i as $,l as U,g as V}from"./index-BCZSM4OO.js";import{f as P,h as _}from"./index-CUYCQoRX.js";import{r as Y}from"./markdown-rpY00XHr.js";const z={class:"font-mono text-sm leading-relaxed mb-6 group max-w-[85%]"},G={class:"text-gray-500"},J={class:"text-gray-600"},K=["innerHTML"],Z=O({__name:"TerminalBlock",props:{content:{},type:{},timestamp:{}},setup(o){const v=o;function m(u){return new Date(u).toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"})}const l=A(()=>Y(v.content));return(u,p)=>(n(),a("div",z,[e("div",{class:b(["flex items-center gap-2 mb-1 opacity-50 group-hover:opacity-100 transition-opacity select-none",{"flex-row-reverse":o.type==="user"}])},[e("span",{class:b(o.type==="user"?"text-neon-cyan":o.type==="assistant"?"text-neon-violet":"text-orange-400")},r(o.type==="user"?"root@user":o.type==="assistant"?"memex@ai":"tool@call"),3),p[0]||(p[0]=e("span",{class:"text-gray-600"},"::",-1)),e("span",G,"["+r(m(o.timestamp))+"]",1),e("span",J,r(o.type==="user"?"<<":">>"),1)],2),e("div",{class:b(["markdown-content break-words py-2",[o.type==="user"?"text-white border-r-2 border-neon-cyan/50 bg-neon-cyan/5 pr-4 pl-2 text-right":"text-gray-300 border-l-2 border-neon-violet/50 pl-4"]])},[e("div",{class:"text-left",innerHTML:l.value},null,8,K)],2)]))}}),q={class:"h-full flex flex-col bg-black font-mono text-gray-300"},Q={class:"flex items-center justify-between px-4 py-2 border-b border-white/10 bg-surface-100 select-none"},W={class:"flex items-center gap-4"},X={class:"text-neon-cyan"},ee={key:0,class:"inline-flex items-center px-2 py-0.5 rounded bg-white/5 border border-white/10 text-[10px] uppercase tracking-wide"},te={key:1,class:"text-[10px] text-gray-500 bg-white/5 border border-white/5 px-2 py-0.5 rounded"},se={key:0,class:"text-neon-cyan animate-pulse"},ae={key:1,class:"text-red-500"},ne={class:"text-gray-500 mb-8 text-xs"},oe={class:"flex flex-col"},le={key:0,class:"py-4 text-center"},re={key:0,class:"text-gray-500 mt-8 text-xs border-t border-white/10 pt-4"},C=50,de=O({__name:"SessionDetailView",setup(o){const v=j(),m=U(),l=c(null),u=c([]),p=c(!0),y=c(!1),f=c(null),x=c(!0),g=c(0),i=c(null),S=v.params.sessionId||v.params.id,N=v.params.projectId,k=!!N;async function R(){p.value=!0,f.value=null;try{l.value=await P(S);const t=await _(S,C,0);u.value=t.data,g.value=t.data.length,x.value=t.data.length<t.total,E(()=>{L()})}catch(t){console.error("Failed to load session data:",t),f.value="CONNECTION REFUSED"}finally{p.value=!1}}async function D(){if(!(y.value||!x.value)){y.value=!0;try{const t=await _(S,C,g.value);u.value.push(...t.data),g.value+=t.data.length,x.value=g.value<t.total}catch(t){console.error("Failed to load more messages:",t)}finally{y.value=!1}}}function T(){if(!i.value)return;const{scrollTop:t,scrollHeight:s,clientHeight:d}=i.value;s-t-d<200&&D()}function L(){i.value&&(i.value.scrollTop=i.value.scrollHeight)}function M(){k?m.push(`/projects/${N}`):m.push("/search")}return B(()=>{R(),E(()=>{i.value?.addEventListener("scroll",T)})}),F(()=>{i.value?.removeEventListener("scroll",T)}),(t,s)=>(n(),a("div",q,[e("div",Q,[e("div",W,[e("button",{onClick:M,class:"hover:text-neon-cyan transition-colors"}," ["+r(k?"PROJECT":"SEARCH")+"] ",1),e("span",X,"SESSION: "+r(l.value?.id),1),l.value?(n(),a("span",ee,[e("span",{style:H({color:(l.value.source||"claude").toLowerCase()==="claude"?"#D97757":"#00f3ff"})},r((l.value.source||"claude").toUpperCase()),5)])):h("",!0),l.value?.cwd?(n(),a("span",te,r(l.value.cwd),1)):h("",!0)]),s[0]||(s[0]=e("div",{class:"flex gap-4 text-xs text-gray-500"},[e("span",null,"STATUS: READ_ONLY"),e("span",null,"ENCRYPTION: NONE")],-1))]),e("div",{ref_key:"messagesContainer",ref:i,class:"flex-1 overflow-y-auto p-4 scroll-smooth"},[p.value?(n(),a("div",se," > ESTABLISHING CONNECTION... ")):f.value?(n(),a("div",ae," > ERROR: "+r(f.value),1)):(n(),a(I,{key:2},[e("div",ne,[s[1]||(s[1]=w(" > SYSTEM INITIALIZED",-1)),s[2]||(s[2]=e("br",null,null,-1)),w(" > LOADED "+r(u.value.length)+" PACKETS",1),s[3]||(s[3]=e("br",null,null,-1)),s[4]||(s[4]=w(" > BEGIN TRANSMISSION... ",-1))]),e("div",oe,[(n(!0),a(I,null,$(u.value,d=>(n(),a("div",{key:d.id,class:b(["flex w-full",d.type==="user"?"justify-end":"justify-start"])},[V(Z,{content:d.content,type:d.type,timestamp:d.timestamp},null,8,["content","type","timestamp"])],2))),128)),y.value?(n(),a("div",le,[...s[5]||(s[5]=[e("div",{class:"i-carbon-circle-dash animate-spin text-xl text-neon-cyan inline-block"},null,-1)])])):h("",!0)]),x.value?h("",!0):(n(),a("div",re," > END OF TRANSMISSION "))],64))],512)]))}});export{de as default};
